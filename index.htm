<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IGCSE BrainBoost - Premium Revision Notes</title>
    
    <!-- 1. Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- 3. Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- 4. Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- 5. Google Identity -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <!-- Custom Styles -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        
        body { font-family: 'Inter', sans-serif; }
        
        /* Animations */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes float { 
            0% { transform: translateY(0px); } 
            50% { transform: translateY(-10px); } 
            100% { transform: translateY(0px); } 
        }
        @keyframes fadeZoom {
            0% { opacity: 0; transform: scale(0.6); }
            50% { opacity: 1; transform: scale(1.05); }
            100% { opacity: 1; transform: scale(1); }
        }

        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        .animate-slide-up { animation: slideUp 0.6s ease-out forwards; }
        .animate-float { animation: float 6s ease-in-out infinite; }
        
        /* Glassmorphism Utilities */
        .glass-card { 
            background: rgba(30, 41, 59, 0.6); 
            backdrop-filter: blur(12px); 
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05); 
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1); 
        }
        
        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #0F172A; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #475569; }

        /* Intro Logo Style */
        #intro-logo {
            width: 280px;
            opacity: 0;
            animation: fadeZoom 2s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        }
    </style>
</head>
<body class="bg-[#0F172A] text-white antialiased scroll-smooth">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ==========================================
        // 1. ICONS (SVG Components)
        // ==========================================
        const IconBase = ({ size = 24, className = "", children, ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>
                {children}
            </svg>
        );

        const Search = (props) => <IconBase {...props}><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></IconBase>;
        const BookOpen = (props) => <IconBase {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></IconBase>;
        const Download = (props) => <IconBase {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></IconBase>;
        const ChevronRight = (props) => <IconBase {...props}><polyline points="9 18 15 12 9 6"/></IconBase>;
        const ChevronDown = (props) => <IconBase {...props}><polyline points="6 9 12 15 18 9"/></IconBase>;
        const Menu = (props) => <IconBase {...props}><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></IconBase>;
        const X = (props) => <IconBase {...props}><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></IconBase>;
        const Zap = (props) => <IconBase {...props}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></IconBase>;
        const FileText = (props) => <IconBase {...props}><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></IconBase>;
        const CheckCircle = (props) => <IconBase {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></IconBase>;
        const Layers = (props) => <IconBase {...props}><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></IconBase>;
        const Shield = (props) => <IconBase {...props}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></IconBase>;
        const Lightbulb = (props) => <IconBase {...props}><line x1="12" y1="2" x2="12" y2="6"/><line x1="12" y1="18" x2="12" y2="22"/><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"/><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"/><line x1="2" y1="12" x2="6" y2="12"/><line x1="18" y1="12" x2="22" y2="12"/><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"/><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"/></IconBase>;
        const AlertTriangle = (props) => <IconBase {...props}><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></IconBase>;
        const Loader = (props) => <IconBase {...props}><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/></IconBase>;
        const Upload = (props) => <IconBase {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></IconBase>;
        const Plus = (props) => <IconBase {...props}><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></IconBase>;
        const Lock = (props) => <IconBase {...props}><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></IconBase>;
        const ArrowRight = (props) => <IconBase {...props}><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></IconBase>;
        const ClipboardList = (props) => <IconBase {...props}><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></IconBase>;
        const ShoppingCart = (props) => <IconBase {...props}><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></IconBase>;
        const Grid = (props) => <IconBase {...props}><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></IconBase>;
        const File = (props) => <IconBase {...props}><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"/><polyline points="13 2 13 9 20 9"/></IconBase>;
        const LinkIcon = (props) => <IconBase {...props}><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></IconBase>;
        const PenTool = (props) => <IconBase {...props}><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="M2 2l7.586 7.586"/><circle cx="11" cy="11" r="2"/></IconBase>;
        const Eye = (props) => <IconBase {...props}><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></IconBase>;

        function ActivityIcon(props) { return <IconBase {...props}><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" /></IconBase>; }
        function CalculateIcon(props) { return <IconBase {...props}><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" /></IconBase>; }
        function MonitorIcon(props) { return <IconBase {...props}><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></IconBase>; }

        // ==========================================
        // 2. DATA & HELPERS
        // ==========================================
        const getSubjectMetadata = (name) => {
            const n = name ? name.toLowerCase() : '';
            if (n.includes('physics')) return { Icon: Zap, color: 'text-cyan-400', bg: 'bg-cyan-500/20', gradient: 'from-cyan-500 to-blue-600' };
            if (n.includes('chem')) return { Icon: Layers, color: 'text-purple-400', bg: 'bg-purple-500/20', gradient: 'from-purple-500 to-indigo-600' };
            if (n.includes('bio')) return { Icon: ActivityIcon, color: 'text-emerald-400', bg: 'bg-emerald-500/20', gradient: 'from-emerald-500 to-teal-600' };
            if (n.includes('math')) return { Icon: CalculateIcon, color: 'text-rose-400', bg: 'bg-rose-500/20', gradient: 'from-rose-500 to-pink-600' };
            if (n.includes('ict') || n.includes('computer')) return { Icon: MonitorIcon, color: 'text-amber-400', bg: 'bg-amber-500/20', gradient: 'from-amber-500 to-orange-600' };
            return { Icon: BookOpen, color: 'text-indigo-600', bg: 'bg-indigo-100', gradient: 'from-indigo-400 to-indigo-600' };
        };

        // Fallback Mock Data (Used if Supabase fetch fails)
        const MOCK_PREMIUM_NOTES = [
            { 
                id: 1, 
                title: 'Physics A* Masterclass', 
                price: '₹59', 
                subject: 'Physics', 
                image: 'https://placehold.co/400x300/1E293B/3B82F6?text=Physics+Notes',
                chapters: ['1. Forces & Motion', '2. Electricity', '3. Waves', '4. Energy Resources', '5. Thermal Physics', '6. Magnetism', '7. Nuclear Physics', '8. Space Physics'] 
            },
            { 
                id: 2, 
                title: 'Chemistry Complete', 
                price: '₹59', 
                subject: 'Chemistry', 
                image: 'https://placehold.co/400x300/1E293B/8B5CF6?text=Chem+Notes',
                chapters: ['1. States of Matter', '2. Atoms & Elements', '3. Stoichiometry', '4. Electrochemistry', '5. Chemical Energetics', '6. Organic Chemistry', '7. Acids & Bases'] 
            },
            { 
                id: 3, 
                title: 'Biology Revision', 
                price: '₹59', 
                subject: 'Biology', 
                image: 'https://placehold.co/400x300/1E293B/10B981?text=Bio+Notes',
                chapters: ['1. Cell Structure', '2. Movement In/Out of Cells', '3. Biological Molecules', '4. Enzymes', '5. Plant Nutrition', '6. Human Nutrition', '7. Transport'] 
            },
            { 
                id: 4, 
                title: 'Math Formulae & Qs', 
                price: '₹59', 
                subject: 'Math', 
                image: 'https://placehold.co/400x300/1E293B/EC4899?text=Math+Notes',
                chapters: ['1. Number', '2. Algebra', '3. Functions', '4. Geometry', '5. Trigonometry', '6. Vectors', '7. Probability', '8. Statistics'] 
            },
        ];

        const MOCK_AFFILIATE = [
            { id: 1, title: 'Casio FX-991EX', desc: 'Essential calculator for IGCSE Math', link: '#', image: 'https://m.media-amazon.com/images/I/71PpbcC7HXL._AC_SL1500_.jpg' },
            { id: 2, title: 'CGP Physics Guide', desc: 'Best revision guide for quick study', link: '#', image: 'https://m.media-amazon.com/images/I/81L14r1+LcL._SL1500_.jpg' },
            { id: 3, title: 'Past Paper Pack', desc: '10 years of solved papers', link: '#', image: 'https://placehold.co/300x300/1E293B/FFF?text=Past+Papers' },
        ];

        const MOCK_BLOGS = [
            { id: 1, title: 'How to Score A* in Physics', desc: 'Top 5 strategies used by toppers.', tags: ['Strategy', 'Physics'], image: 'https://placehold.co/600x400/1E293B/FFF?text=Study+Tips' },
            { id: 2, title: 'Last Minute Revision Hacks', desc: 'What to do 24 hours before the exam.', tags: ['Hacks', 'General'], image: 'https://placehold.co/600x400/1E293B/FFF?text=Exam+Hacks' },
        ];

        // ==========================================
        // 3. SUB-COMPONENTS
        // ==========================================

        const AccordionUnit = ({ unit, subject, onChapterClick }) => {
            const [isOpen, setIsOpen] = useState(true);

            return (
                <div className="bg-[#1E293B]/60 backdrop-blur-sm rounded-[1.5rem] shadow-sm border border-white/5 overflow-hidden transition-all hover:border-white/10 hover:shadow-md">
                    <button onClick={() => setIsOpen(!isOpen)} className="w-full px-8 py-6 flex items-center justify-between hover:bg-white/5 transition-colors">
                        <span className="font-bold text-lg text-white flex items-center">{unit.title}</span>
                        <div className={`w-8 h-8 rounded-full bg-white/5 flex items-center justify-center transition-transform duration-300 ${isOpen ? 'rotate-180 bg-[#3B82F6]/20 text-[#3B82F6]' : 'text-gray-400'}`}>
                            <ChevronDown size={18} />
                        </div>
                    </button>
                    {isOpen && (
                        <div className="border-t border-white/5">
                            {unit.chapters.map((chap) => (
                                <div key={chap.id} className="p-5 px-8 hover:bg-[#3B82F6]/10 transition-colors border-b border-white/5 last:border-none flex flex-col sm:flex-row sm:items-center justify-between gap-4 group cursor-pointer" onClick={() => onChapterClick(chap)}>
                                    <div className="flex-1">
                                        <div className="flex items-center mb-1.5">
                                            <div className="w-2 h-2 rounded-full bg-gray-600 mr-3 group-hover:bg-[#3B82F6] transition-colors"></div>
                                            <h4 className="font-semibold text-gray-300 group-hover:text-[#3B82F6] transition-colors text-base">{chap.title}</h4>
                                            {chap.hasPdf && <span className="ml-3 text-[10px] font-bold bg-[#3B82F6]/20 text-[#3B82F6] px-2.5 py-1 rounded-md uppercase tracking-wide border border-[#3B82F6]/30">PDF</span>}
                                        </div>
                                        <p className="text-sm text-gray-500 pl-5 group-hover:text-gray-400 transition-colors">{chap.desc}</p>
                                    </div>
                                    <div className="flex items-center pl-5 sm:pl-0">
                                        <button className="px-5 py-2.5 bg-white/5 border border-white/10 text-gray-400 text-xs font-bold rounded-xl group-hover:border-[#3B82F6]/50 group-hover:text-white group-hover:bg-[#3B82F6] transition-all shadow-sm">Open Notes</button>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        const Navbar = ({ currentPage, navigateTo, mobileMenuOpen, setMobileMenuOpen }) => (
            <nav className="sticky top-0 z-50 bg-[#0F172A]/90 backdrop-blur-xl border-b border-white/10 shadow-lg transition-all duration-300">
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div className="flex justify-between h-20 items-center">
                        <div onClick={() => navigateTo('home')} className="flex items-center cursor-pointer group">
                            <div className="bg-gradient-to-tr from-[#3B82F6] to-[#8B5CF6] text-white p-2.5 rounded-xl mr-3 group-hover:scale-110 transition-transform duration-300 shadow-[0_0_15px_rgba(59,130,246,0.5)]">
                                <BookOpen size={24} />
                            </div>
                            <span className="font-extrabold text-2xl tracking-tight text-white">
                                IGCSE <span className="text-transparent bg-clip-text bg-gradient-to-r from-[#3B82F6] to-[#8B5CF6]">BrainBoost</span>
                            </span>
                        </div>
                        <div className="hidden md:flex space-x-2 items-center bg-[#1E293B]/80 p-1.5 rounded-full border border-white/5 backdrop-blur-md">
                            {['Home', 'Subjects', 'About', 'Contact'].map((item) => (
                                <button key={item} onClick={() => navigateTo(item.toLowerCase())} className={`px-6 py-2 rounded-full text-sm font-semibold transition-all duration-300 ${currentPage === item.toLowerCase() ? 'bg-gradient-to-r from-[#3B82F6] to-[#8B5CF6] text-white shadow-lg' : 'text-gray-400 hover:text-white hover:bg-white/10'}`}>
                                    {item}
                                </button>
                            ))}
                        </div>
                        <div className="hidden md:block">
                            <button onClick={() => navigateTo('login')} className="bg-white/10 text-white px-6 py-2.5 rounded-full text-sm font-bold border border-white/20 hover:bg-white/20 hover:shadow-[0_0_20px_rgba(255,255,255,0.2)] transition-all duration-300 backdrop-blur-md">Login</button>
                        </div>
                        <div className="md:hidden flex items-center">
                            <button onClick={() => setMobileMenuOpen(!mobileMenuOpen)} className="text-white p-2 rounded-lg hover:bg-white/10 transition-colors">{mobileMenuOpen ? <X size={24} /> : <Menu size={24} />}</button>
                        </div>
                    </div>
                </div>
                {mobileMenuOpen && (
                    <div className="md:hidden bg-[#0F172A]/95 backdrop-blur-xl border-t border-white/10 absolute w-full shadow-2xl animate-fade-in">
                        <div className="px-4 pt-2 pb-6 space-y-2">
                            {['Home', 'Subjects', 'About', 'Contact', 'Admin'].map((item) => (
                                <button key={item} onClick={() => navigateTo(item.toLowerCase())} className="block w-full text-left px-4 py-4 rounded-xl text-lg font-bold text-gray-300 hover:text-white hover:bg-white/10 transition-all">{item}</button>
                            ))}
                        </div>
                    </div>
                )}
            </nav>
        );

        const Footer = ({ navigateTo }) => (
            <footer className="bg-[#0F172A] text-white pt-20 pb-10 mt-auto relative overflow-hidden border-t border-white/10">
                <div className="absolute bottom-0 left-1/2 -translate-x-1/2 w-full h-64 bg-gradient-to-t from-[#3B82F6]/20 to-transparent pointer-events-none"></div>
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-12 mb-16">
                        <div className="col-span-1 md:col-span-1">
                            <div className="flex items-center mb-6">
                                <div className="bg-white/5 p-2 rounded-xl border border-white/10 mr-3"><BookOpen className="text-[#3B82F6]" size={24}/></div>
                                <span className="font-bold text-2xl tracking-tight text-white">IGCSE BrainBoost</span>
                            </div>
                            <p className="text-gray-400 text-sm leading-relaxed mb-6">Premium revision notes designed to help students score A* across Cambridge & Edexcel syllabuses.</p>
                        </div>
                        {[ { title: "Resources", links: ["Physics Notes", "Chemistry Notes", "Past Papers", "Formula Sheets"] }, { title: "Company", links: ["About Us", "Contact", "Privacy Policy", "Terms of Service"], admin: true } ].map((col, idx) => (
                            <div key={idx}>
                                <h4 className="font-bold mb-6 text-lg text-white">{col.title}</h4>
                                <ul className="space-y-4 text-sm text-gray-400">
                                    {col.links.map((link, i) => (
                                        <li key={i} onClick={() => link === "About Us" ? navigateTo('about') : link === "Contact" ? navigateTo('contact') : null} className="hover:text-[#3B82F6] cursor-pointer transition-colors flex items-center group">
                                            <span className="w-0 group-hover:w-2 h-0.5 bg-[#3B82F6] mr-0 group-hover:mr-2 transition-all duration-300"></span>{link}
                                        </li>
                                    ))}
                                    {col.admin && <li onClick={() => navigateTo('admin')} className="hover:text-white cursor-pointer text-gray-600 hover:text-gray-400 pt-4 text-xs font-mono tracking-widest uppercase">Admin Login</li>}
                                </ul>
                            </div>
                        ))}
                        <div>
                            <h4 className="font-bold mb-6 text-lg text-white">Stay Updated</h4>
                            <div className="flex bg-white/5 p-1 rounded-xl border border-white/10 focus-within:border-[#3B82F6] transition-colors shadow-inner">
                                <input type="email" placeholder="Enter email" className="bg-transparent text-white px-4 py-2 text-sm w-full focus:outline-none placeholder-gray-500" />
                                <button className="bg-gradient-to-r from-[#3B82F6] to-[#8B5CF6] px-4 py-2 rounded-lg hover:shadow-[0_0_15px_rgba(139,92,246,0.5)] transition-all text-white shadow-lg"><ArrowRight size={18} /></button>
                            </div>
                        </div>
                    </div>
                    <div className="border-t border-white/10 pt-8 text-center text-gray-500 text-sm flex flex-col gap-3">
                        <p>© 2025 IGCSE BrainBoost. All rights reserved.</p>
                        <p className="text-gray-600 text-xs font-medium tracking-wide uppercase opacity-70">Powered by KAVIN GOLBAL WEB DEVELOPMETN PRIVATE LIMITED.LTD</p>
                    </div>
                </div>
            </footer>
        );

        const Toast = ({ notification }) => {
            if (!notification) return null;
            return (
                <div className="fixed bottom-8 right-8 z-50 animate-slide-up">
                    <div className={`rounded-2xl shadow-2xl p-5 flex items-center border ${notification.type === 'error' ? 'bg-[#1E293B] border-red-500/50 text-red-400' : 'bg-[#1E293B] border-[#3B82F6]/50 text-white'}`}>
                        <div className={`p-2 rounded-full mr-4 ${notification.type === 'error' ? 'bg-red-500/20' : 'bg-[#3B82F6]/20'}`}>
                            {notification.type === 'error' ? <AlertTriangle className="text-red-500" size={24}/> : <CheckCircle className="text-[#3B82F6]" size={24} />}
                        </div>
                        <div>
                            <h4 className="font-bold text-base">{notification.type === 'error' ? 'Error' : 'Success'}</h4>
                            <p className="text-sm text-gray-400 mt-0.5">{notification.message}</p>
                        </div>
                    </div>
                </div>
            );
        };

        const IntroScreen = ({ onComplete }) => {
            const audioRef = useRef(null);
            useEffect(() => {
                const audio = audioRef.current;
                if (audio) {
                    audio.volume = 0;
                    const playPromise = audio.play();
                    if (playPromise !== undefined) {
                        playPromise.then(() => {
                            let vol = 0;
                            const interval = setInterval(() => {
                                if (vol < 1.0) { vol += 0.05; audio.volume = Math.min(vol, 1.0); } 
                                else { clearInterval(interval); }
                            }, 120);
                        }).catch((err) => { console.log("Autoplay blocked:", err); });
                    }
                }
                const timer = setTimeout(() => { onComplete(); }, 4000);
                return () => clearTimeout(timer);
            }, [onComplete]);

            return (
                <div className="fixed inset-0 bg-black flex items-center justify-center z-[100] overflow-hidden">
                    <img id="intro-logo" src="https://lh3.googleusercontent.com/rd-gg/AIJ2gl-wDiZkVItQsPUhl-LuIjorFkes5nSB5qs3YdVqDS5_R2eTQEhvCYgHbW_Xx99TNGgN40xtB5PJ_yp7uKLqeqdVQXdaXJ-HetGH34bp1eEb3A9ACHoiH-FA7IIEHlzX5na3mibnqQmYiGEKvPYg5X7d7ycfAbF_nRAVKrILVrRgUQG2e8m2VNuEZVn3Rxp3BTq-dDoCfPZ0wTJiO-3SOdHxzCZYvWNvfS_BYYwnYST0JwZf8gqJ47xaD-4vDjhyd2WMyN-SGQFKNdd5IRv9GjrzviCME0XSQc9URc7uqYw5sTSgxnY48I2CqxsGTyTAxnpAS0lvfzhJIo1dyRcu1SgWvSswbtuck41oE1liMu3qA1XX1Ail9xcZip4tNm-PYIEdI8FByvR4Xtq6aIy1j51s5F1XQR9ed-xYalOHhNsWSbql5ONg_igTcCYLonTPyY4Zu8_DcC8tteYyJ4Mcfpptqa35I1Fs5Zymh71X8ENAjssynxsDGDnY_hRWWhzDdul6KJYYTiVFsVoJkGIKytTYvCCy5a90oFLykcCYT9wuwnyFAV8l6UO43dFrhknT68vTLwFRhhO5ojAxXuNBghiL9K59PkFFXvt4pBGT2DKKP7ni6U11nU1hVrZQpeYSYa6sBuxv58_1gcd0m5UcwR9SlODhUqEDmeOouklAQGsUsjvKlIoEysmxF4DXrIMwoNziO265onDVSaWzJdGaxNezNHQJZkCHOlD5H1U4TmwgtBrEwFJ_Ud_QBGuaSYUDhN56RXiGPUcipHxfrTcFiw8wHFc7l04TBWnNVVA2sGSwhaArhajXiNd4mt0_VwnRHFuWBvuXkepvS7d948l-vb1BwJa_Zi75os70lD1ex57bxUBmrsyxGvTeGzm9MoHfnDaDvocHiYvAWTdCVsv1IZIIHEcGYGz14Ph_yV7ZcimOd67d3cNU_wwClveluAzuWpAr0I7mzjqzSWukgRW4QSpdKGhpUHKqySZ-cZ5-C8gBjj1c3DuS2rCF3G-7LjkpWrp3J5eFcRxGTgTEHbIXkX89MCTLMGodXBTquR7Q6_IKKfcAR5OobAZKou5J05RT1sDr_vV2oK6gwEUHF237BiFhD28rmMnvrxN6CMuRUOUp72HnD0EWdzFBNR73wfNGcf8ABnz_Rn2U5boMX6aQzuQPZ69A7tYX1Uf4SZkDB4gSPonfepqJkuh2eHjvUu8XktXJkbsVyWiy85gn9IpgIBBGBj4HqX_FkOxAirWtlF91VbWew_haU1fYTMoEgtV0XJLYI8I08MlhBuQUFSUfjwpoKQBHowE32QlFQWKGyIIepoKWKDvhMA2mbzqJe2SbJzBRycRlHUldB4ALc3Lt-lC2DNS4wA_qjHlHI_dcnxK4Z1MpdvjOwppZbHXuyTV-b8FJubI217wFTfi4qAyOxnwu23bWGBQ=s1024-rj" alt="Logo" className="object-contain" />
                    <audio ref={audioRef} src="Sonapareeya-Musiq.mp3" preload="auto" />
                </div>
            );
        };

        const LoginPage = () => {
            useEffect(() => {
                const script = document.createElement('script');
                script.src = "https://accounts.google.com/gsi/client";
                script.async = true;
                script.defer = true;
                document.body.appendChild(script);
                return () => { if (document.body.contains(script)) document.body.removeChild(script); }
            }, []);

            return (
                <div className="min-h-screen bg-[#0F172A] flex items-center justify-center py-20 px-4 animate-fade-in relative overflow-hidden">
                    <div className="absolute top-0 right-0 w-[600px] h-[600px] bg-[#3B82F6] rounded-full blur-[120px] opacity-10 animate-float"></div>
                    <div className="absolute bottom-0 left-0 w-[600px] h-[600px] bg-[#8B5CF6] rounded-full blur-[120px] opacity-10 animate-float" style={{animationDelay: '2s'}}></div>
                    <div className="bg-[#1E293B]/80 backdrop-blur-xl p-10 rounded-[2rem] shadow-2xl w-full max-w-md text-center border border-white/10 relative z-10">
                        <div className="mb-6 flex justify-center">
                            <div className="bg-gradient-to-tr from-[#3B82F6] to-[#8B5CF6] p-4 rounded-2xl shadow-[0_0_20px_rgba(139,92,246,0.4)]"><BookOpen className="text-white w-8 h-8" /></div>
                        </div>
                        <h2 className="text-3xl font-extrabold text-white mb-2 tracking-tight">Welcome Back</h2>
                        <p className="text-gray-400 mb-8 font-medium">Sign in to access your premium notes.</p>
                        <div className="flex flex-col items-center justify-center gap-4">
                            <div id="g_id_onload" data-client_id="YOUR_GOOGLE_CLIENT_ID" data-login_uri="https://yourwebsite.com/login-handler" data-auto_prompt="false"></div>
                            <div className="g_id_signin" data-type="standard" data-size="large" data-theme="filled_black" data-text="sign_in_with" data-shape="pill" data-logo_alignment="left"></div>
                        </div>
                    </div>
                </div>
            );
        };

        const AdminPanel = ({ supabaseUrl, supabaseKey, showNotification }) => {
            const [authorized, setAuthorized] = useState(false);
            const [password, setPassword] = useState('');
            const [activeTab, setActiveTab] = useState('dashboard');
            const [subjects, setSubjects] = useState([]);
            
            // Form States
            const [newSubjectName, setNewSubjectName] = useState('');
            const [newChapterTitle, setNewChapterTitle] = useState('');
            const [selectedSubjectId, setSelectedSubjectId] = useState('');
            
            const [uploadSubjectId, setUploadSubjectId] = useState('');
            const [uploadChapterId, setUploadChapterId] = useState('');
            const [uploadChapters, setUploadChapters] = useState([]);
            const [uploadFile, setUploadFile] = useState(null);
            
            // New States for Extended Admin
            const [prodTitle, setProdTitle] = useState('');
            const [prodPrice, setProdPrice] = useState('');
            const [prodSub, setProdSub] = useState('');
            
            const [affTitle, setAffTitle] = useState('');
            const [affLink, setAffLink] = useState('');
            
            const [blogTitle, setBlogTitle] = useState('');
            const [blogContent, setBlogContent] = useState('');

            const [isUploading, setIsUploading] = useState(false);

            useEffect(() => { if (authorized) loadSubjects(); }, [authorized]);
            useEffect(() => { if (uploadSubjectId) loadChaptersForUpload(uploadSubjectId); else { setUploadChapters([]); setUploadChapterId(''); } }, [uploadSubjectId]);

            const checkPassword = (e) => {
                e.preventDefault();
                if (password === 'admin123') { setAuthorized(true); showNotification('Access Granted', 'success'); } 
                else showNotification('Access Denied: Incorrect Password', 'error');
            };

            const loadSubjects = async () => {
                try {
                    const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
                    const { data, error } = await supabase.from('subjects').select('*').order('name', { ascending: true });
                    if (error) throw error;
                    setSubjects(data);
                } catch (err) { console.error(err); }
            };

            const loadChaptersForUpload = async (subjectId) => {
                try {
                    const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
                    const { data, error } = await supabase.from('chapters').select('*').eq('subject_id', subjectId).order('title', { ascending: true });
                    if (error) throw error;
                    setUploadChapters(data);
                } catch (err) { console.error(err); }
            };

            // --- Database Actions ---
            const handleAddSubject = async () => {
                if (!newSubjectName) return;
                try {
                    const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
                    const { error } = await supabase.from('subjects').insert([{ name: newSubjectName }]);
                    if (error) throw error;
                    showNotification('Subject Added!', 'success');
                    setNewSubjectName('');
                    loadSubjects();
                } catch (err) { showNotification(err.message, 'error'); }
            };

            const handleAddProduct = async () => {
                try {
                    const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
                    const { error } = await supabase.from('products').insert([{ title: prodTitle, price: prodPrice, subject: prodSub, is_active: true }]);
                    if (error) throw error;
                    showNotification(`Product "${prodTitle}" added!`, 'success');
                    setProdTitle(''); setProdPrice('');
                } catch (err) { 
                    console.warn("Product insert failed (Table likely missing):", err);
                    showNotification(`Product "${prodTitle}" added (Mock)`, 'success');
                    setProdTitle(''); setProdPrice('');
                }
            };

            const handleAddAffiliate = async () => {
                try {
                    const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
                    const { error } = await supabase.from('affiliate_items').insert([{ title: affTitle, amazon_url: affLink, is_active: true }]);
                    if (error) throw error;
                    showNotification(`Affiliate Link "${affTitle}" added!`, 'success');
                    setAffTitle(''); setAffLink('');
                } catch (err) {
                    console.warn("Affiliate insert failed (Table likely missing):", err);
                    showNotification(`Affiliate Link "${affTitle}" added (Mock)`, 'success');
                    setAffTitle(''); setAffLink('');
                }
            };

            const handleAddBlog = () => {
                showNotification(`Blog Post "${blogTitle}" published (Mock)`, 'success');
                setBlogTitle(''); setBlogContent('');
            };

            const handleUploadFreeNote = async () => {
                if (!uploadChapterId || !uploadFile) { showNotification('Missing details', 'error'); return; }
                setIsUploading(true);
                try {
                    const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
                    // Using 'notes' bucket as in previous implementation, but respecting the folder structure implied by user snippet 'notes/free'
                    const filePath = `free/${Date.now()}-${uploadFile.name}`;
                    
                    // Attempt upload
                    const { error: uploadError } = await supabase.storage.from('notes').upload(filePath, uploadFile);
                    if (uploadError) throw uploadError;
                    
                    const { data: urlData } = supabase.storage.from('notes').getPublicUrl(filePath);
                    
                    // Insert into notes table with is_premium: false
                    const { error: dbError } = await supabase.from('notes').insert([{ 
                        chapter_id: uploadChapterId, 
                        pdf_url: urlData.publicUrl, 
                        title: uploadFile.name,
                        is_premium: false 
                    }]);
                    
                    if (dbError) throw dbError;
                    showNotification('Note Uploaded!', 'success');
                    setUploadFile(null);
                } catch (err) { showNotification('Upload Failed: ' + err.message, 'error'); } finally { setIsUploading(false); }
            };

            if (!authorized) {
                return (
                    <div className="min-h-screen bg-[#0F172A] flex items-center justify-center p-4">
                        <div className="bg-[#1E293B]/80 backdrop-blur-xl p-8 rounded-[2rem] shadow-2xl w-full max-w-sm border border-white/10">
                            <div className="flex justify-center mb-6 text-[#3B82F6] bg-white/5 p-4 rounded-full w-20 h-20 mx-auto items-center border border-white/5"><Lock size={32} /></div>
                            <h2 className="text-2xl font-bold text-center text-white mb-2">Admin Panel</h2>
                            <form onSubmit={checkPassword}><input type="password" value={password} onChange={(e) => setPassword(e.target.value)} placeholder="Password" className="w-full bg-[#0F172A] text-white border border-white/10 rounded-xl p-4 mt-4 outline-none"/><button type="submit" className="w-full bg-[#3B82F6] text-white font-bold py-4 rounded-xl mt-4">Unlock</button></form>
                        </div>
                    </div>
                );
            }

            const SidebarItem = ({ id, icon: Icon, label }) => (
                <button onClick={() => setActiveTab(id)} className={`w-full flex items-center p-3 rounded-xl mb-1 transition-all ${activeTab === id ? 'bg-[#3B82F6] text-white shadow-lg' : 'text-gray-400 hover:bg-white/5 hover:text-white'}`}>
                    <Icon size={20} className="mr-3"/> <span className="font-semibold text-sm">{label}</span>
                </button>
            );

            return (
                <div className="min-h-screen bg-[#0F172A] flex pt-20">
                    {/* Sidebar */}
                    <div className="w-64 bg-[#1E293B]/50 border-r border-white/5 p-4 hidden md:block h-[calc(100vh-80px)] fixed left-0 top-20 overflow-y-auto">
                        <div className="mb-6 px-3"><h3 className="text-xs font-bold text-gray-500 uppercase tracking-widest">Main</h3></div>
                        <SidebarItem id="dashboard" icon={Grid} label="Dashboard" />
                        <SidebarItem id="subjects" icon={Layers} label="Manage Subjects" />
                        <SidebarItem id="products" icon={ShoppingCart} label="Manage Products" />
                        <SidebarItem id="freenotes" icon={File} label="Free Notes" />
                        <SidebarItem id="affiliate" icon={LinkIcon} label="Affiliate Items" />
                        <SidebarItem id="blog" icon={PenTool} label="Blog Posts" />
                    </div>

                    {/* Content Area */}
                    <div className="flex-1 md:ml-64 p-8">
                        {activeTab === 'dashboard' && (
                            <div className="animate-fade-in">
                                <h2 className="text-3xl font-bold mb-8">Dashboard Overview</h2>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    {['Total Sales', 'Active Users', 'Downloads'].map((item, i) => (
                                        <div key={i} className="bg-[#1E293B] p-6 rounded-2xl border border-white/5"><h3 className="text-gray-400 text-sm">{item}</h3><p className="text-3xl font-bold text-white mt-2">{Math.floor(Math.random() * 1000)}</p></div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {activeTab === 'subjects' && (
                            <div className="max-w-2xl animate-slide-up">
                                <h2 className="text-2xl font-bold mb-6">Manage Subjects</h2>
                                <div className="bg-[#1E293B] p-6 rounded-2xl border border-white/5 mb-6">
                                    <h4 className="font-bold mb-4">Add New Subject</h4>
                                    <div className="flex gap-4">
                                        <input value={newSubjectName} onChange={(e) => setNewSubjectName(e.target.value)} placeholder="Subject Name" className="flex-1 bg-[#0F172A] border border-white/10 rounded-xl p-3 outline-none"/>
                                        <button onClick={handleAddSubject} className="bg-[#3B82F6] px-6 rounded-xl font-bold">Add</button>
                                    </div>
                                </div>
                                <div className="space-y-2">
                                    {subjects.map(s => <div key={s.id} className="p-4 bg-[#1E293B]/50 rounded-xl border border-white/5 flex justify-between">{s.name} <span className="text-green-400 text-xs bg-green-400/10 px-2 py-1 rounded">Active</span></div>)}
                                </div>
                            </div>
                        )}

                        {activeTab === 'products' && (
                            <div className="max-w-2xl animate-slide-up">
                                <h2 className="text-2xl font-bold mb-6">Manage Premium Notes (₹59)</h2>
                                <div className="bg-[#1E293B] p-6 rounded-2xl border border-white/5">
                                    <input value={prodTitle} onChange={(e) => setProdTitle(e.target.value)} placeholder="Product Title" className="w-full bg-[#0F172A] border border-white/10 rounded-xl p-3 mb-4 outline-none"/>
                                    <input value={prodPrice} onChange={(e) => setProdPrice(e.target.value)} placeholder="Price (e.g. 59)" className="w-full bg-[#0F172A] border border-white/10 rounded-xl p-3 mb-4 outline-none"/>
                                    <select onChange={(e) => setProdSub(e.target.value)} className="w-full bg-[#0F172A] border border-white/10 rounded-xl p-3 mb-4 outline-none text-gray-400">
                                        <option>Select Subject</option>
                                        {subjects.map(s => <option key={s.id} value={s.id}>{s.name}</option>)}
                                    </select>
                                    <button onClick={handleAddProduct} className="w-full bg-[#3B82F6] py-3 rounded-xl font-bold">Create Product</button>
                                </div>
                            </div>
                        )}

                        {activeTab === 'freenotes' && (
                            <div className="max-w-2xl animate-slide-up">
                                <h2 className="text-2xl font-bold mb-6">Manage Free Notes</h2>
                                <div className="bg-[#1E293B] p-6 rounded-2xl border border-white/5">
                                    <select value={uploadSubjectId} onChange={(e) => setUploadSubjectId(e.target.value)} className="w-full bg-[#0F172A] border border-white/10 rounded-xl p-3 mb-4 outline-none"><option value="">Select Subject</option>{subjects.map(s => <option key={s.id} value={s.id}>{s.name}</option>)}</select>
                                    <select value={uploadChapterId} onChange={(e) => setUploadChapterId(e.target.value)} disabled={!uploadSubjectId} className="w-full bg-[#0F172A] border border-white/10 rounded-xl p-3 mb-4 outline-none"><option value="">Select Chapter</option>{uploadChapters.map(c => <option key={c.id} value={c.id}>{c.title}</option>)}</select>
                                    <input type="file" onChange={(e) => setUploadFile(e.target.files[0])} className="mb-4 block w-full text-sm text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-[#3B82F6] file:text-white hover:file:bg-blue-600"/>
                                    <button onClick={handleUploadFreeNote} disabled={isUploading} className="w-full bg-green-600 py-3 rounded-xl font-bold">{isUploading ? 'Uploading...' : 'Upload PDF'}</button>
                                </div>
                            </div>
                        )}

                        {activeTab === 'affiliate' && (
                            <div className="max-w-2xl animate-slide-up">
                                <h2 className="text-2xl font-bold mb-6">Manage Affiliate Items</h2>
                                <div className="bg-[#1E293B] p-6 rounded-2xl border border-white/5">
                                    <input value={affTitle} onChange={(e) => setAffTitle(e.target.value)} placeholder="Item Name" className="w-full bg-[#0F172A] border border-white/10 rounded-xl p-3 mb-4 outline-none"/>
                                    <input value={affLink} onChange={(e) => setAffLink(e.target.value)} placeholder="Amazon Link" className="w-full bg-[#0F172A] border border-white/10 rounded-xl p-3 mb-4 outline-none"/>
                                    <button onClick={handleAddAffiliate} className="w-full bg-purple-600 py-3 rounded-xl font-bold">Add Item</button>
                                </div>
                            </div>
                        )}

                        {activeTab === 'blog' && (
                            <div className="max-w-2xl animate-slide-up">
                                <h2 className="text-2xl font-bold mb-6">Manage Blog Posts</h2>
                                <div className="bg-[#1E293B] p-6 rounded-2xl border border-white/5">
                                    <input value={blogTitle} onChange={(e) => setBlogTitle(e.target.value)} placeholder="Blog Title" className="w-full bg-[#0F172A] border border-white/10 rounded-xl p-3 mb-4 outline-none"/>
                                    <textarea value={blogContent} onChange={(e) => setBlogContent(e.target.value)} placeholder="Content..." rows="6" className="w-full bg-[#0F172A] border border-white/10 rounded-xl p-3 mb-4 outline-none"></textarea>
                                    <button onClick={handleAddBlog} className="w-full bg-pink-600 py-3 rounded-xl font-bold">Publish Post</button>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // ==========================================
        // 4. MAIN APP COMPONENT
        // ==========================================
        const App = () => {
            const [currentPage, setCurrentPage] = useState('home');
            const [showIntro, setShowIntro] = useState(true); 
            const [selectedSubject, setSelectedSubject] = useState(null);
            const [selectedChapter, setSelectedChapter] = useState(null);
            const [selectedProduct, setSelectedProduct] = useState(null); // New state for premium product detail
            const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
            const [notification, setNotification] = useState(null);
            const [subjectsData, setSubjectsData] = useState([]);
            
            // New State for Dynamic Sections
            const [premiumProducts, setPremiumProducts] = useState(MOCK_PREMIUM_NOTES);
            const [freeNotesList, setFreeNotesList] = useState([]);
            const [affiliateItems, setAffiliateItems] = useState(MOCK_AFFILIATE);
            
            const [isLoading, setIsLoading] = useState(true);
            const [isSupabaseReady, setIsSupabaseReady] = useState(false);

            const supabaseUrl = 'https://emrtjgbniuicqnakwmwm.supabase.co'; 
            const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVtcnRqZ2JuaXVpY3FuYWt3bXdtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzODQ5NjQsImV4cCI6MjA3OTk2MDk2NH0.7q85t3wJhGswvd9CogAJTKAd4gUR9_CGsM_Z7syLATw';

            useEffect(() => {
                if (window.supabase) { setIsSupabaseReady(true); return; }
                const interval = setInterval(() => {
                    if (window.supabase) {
                        setIsSupabaseReady(true);
                        clearInterval(interval);
                    }
                }, 100);
                return () => clearInterval(interval);
            }, []);

            useEffect(() => {
                async function fetchData() {
                    if (!isSupabaseReady) return;
                    try {
                        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
                        
                        // 1. Fetch Subjects & Chapters (Existing Logic)
                        const { data: subjects, error: subError } = await supabase.from("subjects").select("*").order("name", { ascending: true });
                        if (subError) throw subError;
                        const builtSubjects = [];
                        for (let subject of subjects) {
                            const meta = getSubjectMetadata(subject.name);
                            const subjectObj = { 
                                id: subject.id, 
                                title: subject.name, 
                                IconComponent: meta.Icon, 
                                color: meta.color, 
                                bgColor: meta.bg, 
                                gradient: meta.gradient, 
                                description: subject.description || 'Comprehensive study guide.', 
                                fullDescription: `Complete topic-by-topic notes for ${subject.name}.`, 
                                units: [], 
                                chapterCount: 0,
                                syllabusUrl: subject.syllabus_url 
                            };
                            const { data: chapters } = await supabase.from("chapters").select("*").eq("subject_id", subject.id).order("title", { ascending: true });
                            if (chapters) {
                                let totalNotes = 0;
                                for (let chapter of chapters) {
                                   const { data: notes } = await supabase.from("notes").select("*").eq("chapter_id", chapter.id);
                                   const mappedNotes = notes ? notes.map(note => ({ id: note.id, title: note.title || 'Untitled Note', desc: note.description || 'Click to view PDF.', hasPdf: !!note.pdf_url, pdfUrl: note.pdf_url })) : [];
                                   subjectObj.units.push({ title: chapter.title, chapters: mappedNotes });
                                   totalNotes += mappedNotes.length;
                                }
                                subjectObj.chapterCount = totalNotes;
                            }
                            builtSubjects.push(subjectObj);
                        }
                        setSubjectsData(builtSubjects);
                        
                        // 2. Fetch Premium Products
                        const { data: productsData, error: prodError } = await supabase.from('products').select('*').eq('is_active', true);
                        if (!prodError && productsData.length > 0) {
                            // Map DB structure to UI structure if needed, or use directly if matches
                            // Assuming MOCK structure for now if data is missing fields
                            setPremiumProducts(productsData.map(p => ({
                                id: p.id,
                                title: p.title,
                                price: p.price,
                                subject: p.subject || 'General',
                                image: p.image_url || 'https://placehold.co/400x300/1E293B/3B82F6?text=Premium+Note',
                                chapters: p.chapters || []
                            })));
                        }

                        // 3. Fetch Free Notes (where is_premium is false)
                        const { data: freeNotesData, error: notesError } = await supabase.from('notes').select('*').eq('is_premium', false);
                        // We actually use subjectsData for the Free Notes section in the UI, but this fetch verifies the data exists.
                        
                        // 4. Fetch Affiliate Items
                        const { data: affiliateData, error: affError } = await supabase.from('affiliate_items').select('*').eq('is_active', true);
                        if (!affError && affiliateData.length > 0) {
                            setAffiliateItems(affiliateData.map(item => ({
                                id: item.id,
                                title: item.title,
                                desc: item.description,
                                link: item.amazon_url,
                                image: item.image_url || 'https://placehold.co/300x300/1E293B/FFF?text=Item'
                            })));
                        }

                    } catch (error) { 
                        console.error("Error fetching data (Using fallbacks):", error); 
                        // Notification only on critical failure, otherwise fail silently to mocks
                    } finally { setIsLoading(false); }
                }
                fetchData();
            }, [isSupabaseReady]);

            useEffect(() => { window.scrollTo(0, 0); }, [currentPage, selectedSubject, selectedChapter, selectedProduct]);

            const showNotification = (message, type = 'success') => { setNotification({ message, type }); setTimeout(() => setNotification(null), 3000); };

            const navigateTo = (page, subject = null, chapter = null, product = null) => {
                if (subject) setSelectedSubject(subject);
                if (chapter) setSelectedChapter(chapter);
                if (product) setSelectedProduct(product);
                setCurrentPage(page);
                setMobileMenuOpen(false);
            };

            return (
                <div className="font-sans text-white antialiased scroll-smooth bg-[#0F172A]">
                    {showIntro && <IntroScreen onComplete={() => setShowIntro(false)} />}
                    <Navbar currentPage={currentPage} navigateTo={navigateTo} mobileMenuOpen={mobileMenuOpen} setMobileMenuOpen={setMobileMenuOpen} />
                    <main className="min-h-screen">
                        {currentPage === 'home' && (
                            <div className="animate-fade-in">
                                {/* SECTION 1 - HERO */}
                                <div className="relative bg-[#0F172A] overflow-hidden pt-20 pb-40">
                                    <div className="absolute top-0 right-0 -mr-20 -mt-20 w-[600px] h-[600px] rounded-full bg-[#3B82F6] blur-[150px] opacity-20 animate-float"></div>
                                    <div className="absolute bottom-0 left-0 -ml-20 -mb-20 w-[600px] h-[600px] rounded-full bg-[#8B5CF6] blur-[150px] opacity-20 animate-float" style={{animationDelay: '2s'}}></div>
                                    
                                    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 flex flex-col md:flex-row items-center gap-12">
                                        <div className="md:w-1/2 text-left">
                                            <h1 className="text-6xl md:text-8xl font-extrabold text-white mb-6 tracking-tight leading-none">IGCSE <span className="text-transparent bg-clip-text bg-gradient-to-r from-[#3B82F6] to-[#8B5CF6]">BrainBoost</span></h1>
                                            <p className="text-xl text-gray-400 mb-8 leading-relaxed">Free notes, premium revision packs, chapter-wise breakdowns, and curated study tools. Everything you need to score top grades.</p>
                                            <div className="flex gap-4">
                                                <button onClick={() => document.getElementById('free-notes').scrollIntoView({behavior: 'smooth'})} className="bg-white/10 text-white px-8 py-4 rounded-2xl font-bold border border-white/10 hover:bg-white/20 transition-all">Download Free Notes</button>
                                                <button onClick={() => document.getElementById('premium-notes').scrollIntoView({behavior: 'smooth'})} className="bg-gradient-to-r from-[#3B82F6] to-[#8B5CF6] text-white px-8 py-4 rounded-2xl font-bold shadow-lg hover:shadow-[#3B82F6]/50 transition-all">Get Full Notes for ₹59</button>
                                            </div>
                                        </div>
                                        <div className="md:w-1/2 flex justify-center">
                                            <div className="relative bg-[#1E293B]/80 backdrop-blur-xl p-8 rounded-[2.5rem] border border-white/10 shadow-2xl animate-slide-up transform rotate-1 hover:rotate-0 transition-all duration-500">
                                                <div className="absolute top-0 right-0 bg-yellow-400 text-black font-bold px-4 py-2 rounded-bl-2xl rounded-tr-2xl text-sm">BESTSELLER</div>
                                                <h3 className="text-3xl font-extrabold text-white mb-2">Full Premium Bundle</h3>
                                                <p className="text-gray-400 mb-6">Physics • Chem • Bio • Math</p>
                                                <ul className="space-y-2 mb-8 text-sm text-gray-300">
                                                    <li className="flex items-center"><CheckCircle size={16} className="text-green-400 mr-2"/> All Chapters Covered</li>
                                                    <li className="flex items-center"><CheckCircle size={16} className="text-green-400 mr-2"/> Solved Past Paper Qs</li>
                                                    <li className="flex items-center"><CheckCircle size={16} className="text-green-400 mr-2"/> Examiner Tips Included</li>
                                                </ul>
                                                <div className="flex justify-between items-center">
                                                    <div>
                                                        <span className="text-gray-500 line-through text-lg">₹199</span>
                                                        <span className="text-4xl font-bold text-white ml-2">₹59</span>
                                                    </div>
                                                    <button onClick={() => showNotification('Added to cart!')} className="bg-[#3B82F6] p-3 rounded-xl text-white hover:scale-110 transition-transform"><ShoppingCart/></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* SECTION 2 - REVISION VAULT */}
                                <div className="bg-[#0F172A] py-20 border-t border-white/5">
                                    <div className="max-w-7xl mx-auto px-4 text-center">
                                        <span className="text-[#3B82F6] font-bold tracking-widest uppercase text-xs mb-2 block">Revision Vault</span>
                                        <h2 className="text-4xl font-bold text-white mb-4">Your All-in-One Exam Mastery Center</h2>
                                        <p className="text-gray-400 max-w-2xl mx-auto mb-12">Access free chapter notes, premium revision packs, and essential study boosters — all in one clean interface.</p>
                                        
                                        <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                                            <div onClick={() => document.getElementById('free-notes').scrollIntoView({behavior:'smooth'})} className="bg-[#1E293B]/50 p-8 rounded-[2rem] border border-white/5 hover:border-[#3B82F6]/50 cursor-pointer transition-all hover:-translate-y-2 group">
                                                <div className="bg-blue-500/10 p-4 rounded-2xl w-fit mb-6 mx-auto group-hover:bg-blue-500/20"><BookOpen className="text-blue-400" size={32}/></div>
                                                <h3 className="text-xl font-bold text-white mb-2">Free Notes Collection</h3>
                                                <p className="text-gray-400 text-sm">Read chapter-wise summaries instantly.</p>
                                            </div>
                                            <div onClick={() => document.getElementById('premium-notes').scrollIntoView({behavior:'smooth'})} className="bg-[#1E293B]/50 p-8 rounded-[2rem] border border-white/5 hover:border-purple-500/50 cursor-pointer transition-all hover:-translate-y-2 group">
                                                <div className="bg-purple-500/10 p-4 rounded-2xl w-fit mb-6 mx-auto group-hover:bg-purple-500/20"><ShoppingCart className="text-purple-400" size={32}/></div>
                                                <h3 className="text-xl font-bold text-white mb-2">₹59 Premium Notes</h3>
                                                <p className="text-gray-400 text-sm">Download high-quality PDFs.</p>
                                            </div>
                                            <div onClick={() => document.getElementById('affiliate').scrollIntoView({behavior:'smooth'})} className="bg-[#1E293B]/50 p-8 rounded-[2rem] border border-white/5 hover:border-green-500/50 cursor-pointer transition-all hover:-translate-y-2 group">
                                                <div className="bg-green-500/10 p-4 rounded-2xl w-fit mb-6 mx-auto group-hover:bg-green-500/20"><Zap className="text-green-400" size={32}/></div>
                                                <h3 className="text-xl font-bold text-white mb-2">Tools & Resources</h3>
                                                <p className="text-gray-400 text-sm">Best calculators and guides.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* SECTION 3 - PREMIUM NOTES */}
                                <div id="premium-notes" className="py-24 relative overflow-hidden">
                                    <div className="absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-[#3B82F6]/50 to-transparent"></div>
                                    <div className="max-w-7xl mx-auto px-4">
                                        <h2 className="text-4xl font-bold text-white mb-4 text-center">₹59 Premium Notes</h2>
                                        <p className="text-gray-400 text-center max-w-2xl mx-auto mb-12">High-quality, exam-focused PDF notes for each subject. Clear language • Diagrams • Past paper-oriented • Updated for 2025.</p>
                                        <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
                                            {premiumProducts.map((note) => (
                                                <div key={note.id} onClick={() => navigateTo('product-detail', null, null, note)} className="bg-[#1E293B] rounded-3xl overflow-hidden border border-white/5 hover:shadow-2xl hover:shadow-purple-500/10 transition-all group cursor-pointer">
                                                    <div className="h-40 bg-gray-700 relative">
                                                        <img src={note.image} className="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity" alt={note.title}/>
                                                        <div className="absolute bottom-2 right-2 bg-black/50 backdrop-blur-md px-3 py-1 rounded-lg text-xs font-bold border border-white/10">{note.subject}</div>
                                                    </div>
                                                    <div className="p-6">
                                                        <h3 className="font-bold text-lg text-white mb-2 line-clamp-1 group-hover:text-[#3B82F6] transition-colors">{note.title}</h3>
                                                        <div className="flex justify-between items-center mt-4">
                                                            <span className="text-2xl font-bold text-[#3B82F6]">{note.price}</span>
                                                            <button className="bg-white/10 hover:bg-[#3B82F6] p-2 rounded-xl text-white transition-colors"><Plus/></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>

                                {/* SECTION 4 - FREE NOTES */}
                                <div id="free-notes" className="py-24 bg-[#0B1120]">
                                    <div className="max-w-7xl mx-auto px-4">
                                        <h2 className="text-4xl font-bold text-white mb-4 text-center">Free Notes Library</h2>
                                        <p className="text-gray-400 text-center mb-12">Quick-access chapter summaries and sample notes.</p>
                                        
                                        {isLoading ? (
                                            <div className="flex justify-center p-20"><Loader className="animate-spin text-blue-500"/></div>
                                        ) : (
                                            <div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
                                                {subjectsData.map((subject) => (
                                                    <div key={subject.id} onClick={() => navigateTo('subject-selection', subject)} className="bg-[#1E293B]/40 p-6 rounded-2xl border border-white/5 hover:bg-[#1E293B] cursor-pointer transition-all hover:scale-105 text-center">
                                                        <div className={`w-14 h-14 mx-auto rounded-xl bg-gradient-to-br ${subject.gradient} flex items-center justify-center mb-4 text-white shadow-lg`}>
                                                            {subject.IconComponent ? <subject.IconComponent size={24} /> : null}
                                                        </div>
                                                        <h4 className="font-bold text-white">{subject.title}</h4>
                                                        <p className="text-xs text-gray-500 mt-1">{subject.chapterCount} Chapters</p>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                </div>

                                {/* SECTION 5 - AFFILIATE */}
                                <div id="affiliate" className="py-24">
                                    <div className="max-w-7xl mx-auto px-4">
                                        <h2 className="text-3xl font-bold text-white mb-2 text-center">Recommended Study Tools</h2>
                                        <p className="text-gray-400 text-center mb-12">Curated Amazon picks to support your IGCSE study journey.</p>
                                        <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                                            {affiliateItems.map((item) => (
                                                <div key={item.id} className="flex bg-[#1E293B]/60 rounded-2xl overflow-hidden border border-white/5 hover:border-yellow-500/30 transition-all">
                                                    <div className="w-1/3 bg-white p-4 flex items-center justify-center">
                                                        <img src={item.image} className="max-h-24 object-contain"/>
                                                    </div>
                                                    <div className="w-2/3 p-5">
                                                        <h4 className="font-bold text-white text-sm line-clamp-2 mb-1">{item.title}</h4>
                                                        <p className="text-xs text-gray-400 mb-3">{item.desc}</p>
                                                        <button onClick={() => window.open(item.link, '_blank')} className="text-xs bg-yellow-600/20 text-yellow-500 px-3 py-1.5 rounded-lg font-bold hover:bg-yellow-600 hover:text-white transition-colors">Buy on Amazon</button>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>

                                {/* SECTION 6 - BLOG */}
                                <div className="py-24 bg-[#0B1120] border-t border-white/5">
                                    <div className="max-w-7xl mx-auto px-4">
                                        <h2 className="text-3xl font-bold text-white mb-12 text-center">Exam Tips & Strategy</h2>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                                            {MOCK_BLOGS.map((blog) => (
                                                <div key={blog.id} className="group cursor-pointer">
                                                    <div className="rounded-2xl overflow-hidden mb-4 relative h-64">
                                                        <img src={blog.image} className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"/>
                                                        <div className="absolute inset-0 bg-black/20 group-hover:bg-transparent transition-colors"></div>
                                                    </div>
                                                    <div className="flex gap-2 mb-2">
                                                        {blog.tags.map(t => <span key={t} className="text-[10px] uppercase font-bold tracking-wider text-blue-400 bg-blue-400/10 px-2 py-1 rounded">{t}</span>)}
                                                    </div>
                                                    <h3 className="text-xl font-bold text-white mb-2 group-hover:text-blue-400 transition-colors">{blog.title}</h3>
                                                    <p className="text-gray-400 text-sm">{blog.desc}</p>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* PREMIUM PRODUCT DETAIL PAGE */}
                        {currentPage === 'product-detail' && selectedProduct && (
                            <div className="bg-[#0F172A] min-h-screen pb-20 animate-fade-in pt-20">
                                <div className="max-w-7xl mx-auto px-4">
                                    <button onClick={() => navigateTo('home')} className="mb-8 flex items-center text-gray-400 hover:text-white transition-colors"><ChevronRight className="rotate-180 mr-1" size={16}/> Back to Home</button>
                                    
                                    <div className="bg-[#1E293B]/60 border border-white/10 rounded-[3rem] p-8 md:p-12 shadow-2xl relative overflow-hidden mb-12">
                                        <div className="absolute top-0 right-0 w-[400px] h-[400px] bg-[#3B82F6] rounded-full blur-[120px] opacity-10 pointer-events-none"></div>
                                        <div className="flex flex-col md:flex-row gap-12 relative z-10">
                                            <div className="md:w-1/3">
                                                <img src={selectedProduct.image} className="rounded-2xl shadow-2xl w-full object-cover transform hover:scale-105 transition-transform duration-500"/>
                                            </div>
                                            <div className="md:w-2/3 flex flex-col justify-center">
                                                <div className="bg-blue-500/10 text-blue-400 px-4 py-1 rounded-full text-xs font-bold w-fit mb-4 uppercase tracking-wider">{selectedProduct.subject} Premium Pack</div>
                                                <h1 className="text-4xl md:text-5xl font-extrabold text-white mb-4">{selectedProduct.title}</h1>
                                                <p className="text-gray-400 text-lg mb-8 leading-relaxed">Comprehensive, exam-focused revision notes designed to help you master {selectedProduct.subject} and secure top grades.</p>
                                                
                                                <div className="flex items-center gap-6 mb-8">
                                                    <span className="text-5xl font-bold text-[#3B82F6]">{selectedProduct.price}</span>
                                                    <span className="text-gray-500 line-through text-xl">₹199</span>
                                                    <span className="bg-green-500/20 text-green-400 px-3 py-1 rounded-lg text-xs font-bold">70% OFF</span>
                                                </div>

                                                <div className="flex flex-col sm:flex-row gap-4">
                                                    <button onClick={() => showNotification("Opening sample PDF...", "success")} className="flex-1 bg-white/10 border border-white/10 text-white py-4 rounded-xl font-bold hover:bg-white/20 transition-all flex items-center justify-center"><Eye size={20} className="mr-2"/> View Sample</button>
                                                    <button onClick={() => showNotification("Proceeding to payment...", "success")} className="flex-1 bg-gradient-to-r from-[#3B82F6] to-[#8B5CF6] text-white py-4 rounded-xl font-bold shadow-lg hover:shadow-blue-500/30 transition-all flex items-center justify-center transform active:scale-95"><ShoppingCart size={20} className="mr-2"/> Buy Now</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                                        <div className="md:col-span-2">
                                            <h3 className="text-2xl font-bold text-white mb-6 flex items-center"><Layers className="mr-3 text-blue-400"/> What's Inside this Pack?</h3>
                                            <div className="bg-[#1E293B]/40 rounded-3xl border border-white/5 overflow-hidden">
                                                {selectedProduct.chapters && selectedProduct.chapters.map((chapter, index) => (
                                                    <div key={index} className="p-5 border-b border-white/5 last:border-none flex items-center hover:bg-white/5 transition-colors">
                                                        <div className="bg-blue-500/20 text-blue-400 w-10 h-10 rounded-full flex items-center justify-center mr-4 font-bold text-sm">{index + 1}</div>
                                                        <span className="text-gray-300 font-medium">{chapter}</span>
                                                        <div className="ml-auto"><Lock size={16} className="text-gray-600"/></div>
                                                    </div>
                                                ))}
                                                {(!selectedProduct.chapters || selectedProduct.chapters.length === 0) && (
                                                    <div className="p-8 text-center text-gray-500">Chapter details coming soon.</div>
                                                )}
                                            </div>
                                        </div>
                                        <div>
                                            <h3 className="text-2xl font-bold text-white mb-6">Why buy this?</h3>
                                            <div className="space-y-4">
                                                {[
                                                    {icon: <Zap size={20}/>, title: "Instant Access", desc: "Download immediately after purchase."},
                                                    {icon: <CheckCircle size={20}/>, title: "Exam Focused", desc: "Covers 100% of the syllabus."},
                                                    {icon: <PenTool size={20}/>, title: "High Quality", desc: "Crisp diagrams and clear text."}
                                                ].map((feat, i) => (
                                                    <div key={i} className="bg-[#1E293B] p-6 rounded-2xl border border-white/5 flex gap-4">
                                                        <div className="text-blue-400">{feat.icon}</div>
                                                        <div>
                                                            <h4 className="font-bold text-white text-sm">{feat.title}</h4>
                                                            <p className="text-gray-400 text-xs mt-1">{feat.desc}</p>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {currentPage === 'subjects' && (
                            <div className="bg-[#0F172A] min-h-screen pb-20 animate-fade-in pt-20">
                                <div className="max-w-7xl mx-auto px-4 text-center mb-16">
                                    <h1 className="text-5xl font-extrabold mb-6 tracking-tight text-white">Choose Your Subject</h1>
                                    <p className="text-gray-400 max-w-2xl mx-auto text-lg">Select a subject to access comprehensive chapter notes, formula sheets, and past paper questions.</p>
                                </div>
                                <div className="max-w-7xl mx-auto px-4">
                                    {isLoading ? (
                                        <div className="flex justify-center bg-[#1E293B]/50 p-20 rounded-[2rem] shadow-sm border border-white/5"><div className="animate-spin text-[#3B82F6]"><Loader size={40}/></div></div>
                                    ) : (
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                            {subjectsData.map((subject) => (
                                                <div key={subject.id} onClick={() => navigateTo('subject-selection', subject)} className="bg-[#1E293B]/60 backdrop-blur-md p-8 rounded-[2rem] shadow-xl border border-white/5 hover:border-[#3B82F6]/30 hover:bg-[#1E293B]/80 hover:-translate-y-1 transition-all duration-300 cursor-pointer flex flex-col md:flex-row items-start md:items-center gap-8 group">
                                                    <div className={`w-24 h-24 rounded-3xl bg-gradient-to-br ${subject.gradient || 'from-gray-700 to-gray-600'} flex items-center justify-center flex-shrink-0 group-hover:scale-105 transition-transform shadow-lg text-white`}>
                                                        {subject.IconComponent ? <subject.IconComponent size={40} /> : null}
                                                    </div>
                                                    <div className="flex-1">
                                                        <h2 className="text-2xl font-bold text-white mb-2 group-hover:text-[#3B82F6] transition-colors">{subject.title}</h2>
                                                        <p className="text-gray-400 mb-5 leading-relaxed">{subject.fullDescription}</p>
                                                        <div className="flex gap-3">
                                                            <span className="bg-[#3B82F6]/10 text-[#3B82F6] px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wide border border-[#3B82F6]/20">{subject.chapterCount} Notes</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}

                        {/* NEW: Subject Selection Page (Split View) */}
                        {currentPage === 'subject-selection' && selectedSubject && (
                            <div className="bg-[#0F172A] min-h-screen pb-20 animate-fade-in flex flex-col items-center">
                                <div className="w-full bg-[#1E293B]/50 border-b border-white/5 pb-10 pt-10 mb-10 text-center relative overflow-hidden">
                                     <div className="absolute top-0 right-0 p-20 opacity-5 pointer-events-none grayscale">
                                        {selectedSubject.IconComponent ? <selectedSubject.IconComponent size={300} className="text-white" /> : null}
                                    </div>
                                    <div className="relative z-10">
                                         <button onClick={() => navigateTo('subjects')} className="text-gray-400 hover:text-white mb-6 flex items-center text-sm font-bold bg-white/5 hover:bg-white/10 w-fit px-4 py-2 rounded-full transition-colors border border-white/5 mx-auto">
                                            <ChevronRight className="rotate-180 mr-1" size={16} /> Back to Subjects
                                        </button>
                                        <div className={`w-20 h-20 mx-auto rounded-3xl bg-gradient-to-br ${selectedSubject.gradient} flex items-center justify-center shadow-2xl text-white mb-6`}>
                                            {selectedSubject.IconComponent ? <selectedSubject.IconComponent size={32} /> : null}
                                        </div>
                                        <h1 className="text-4xl md:text-5xl font-extrabold text-white mb-3 tracking-tight">{selectedSubject.title}</h1>
                                        <p className="text-gray-400 text-lg max-w-xl mx-auto">What would you like to study today?</p>
                                    </div>
                                </div>

                                <div className="max-w-5xl mx-auto px-4 w-full grid grid-cols-1 md:grid-cols-2 gap-8">
                                    {/* Option 1: Syllabus */}
                                    <div onClick={() => navigateTo('syllabus-view', selectedSubject)} className="bg-[#1E293B]/60 backdrop-blur-md p-10 rounded-[2.5rem] shadow-xl border border-white/5 hover:border-[#3B82F6]/50 hover:bg-[#1E293B] hover:-translate-y-2 transition-all duration-300 cursor-pointer group flex flex-col items-center text-center">
                                        <div className="w-24 h-24 bg-pink-500/20 text-pink-400 rounded-full flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300">
                                            <ClipboardList size={40} />
                                        </div>
                                        <h2 className="text-2xl font-bold text-white mb-2 group-hover:text-pink-400 transition-colors">View Syllabus</h2>
                                        <p className="text-gray-400">Download and view the official 2025 IGCSE syllabus PDF.</p>
                                    </div>

                                    {/* Option 2: Notes */}
                                    <div onClick={() => navigateTo('subject-detail', selectedSubject)} className="bg-[#1E293B]/60 backdrop-blur-md p-10 rounded-[2.5rem] shadow-xl border border-white/5 hover:border-[#3B82F6]/50 hover:bg-[#1E293B] hover:-translate-y-2 transition-all duration-300 cursor-pointer group flex flex-col items-center text-center">
                                        <div className="w-24 h-24 bg-[#3B82F6]/20 text-[#3B82F6] rounded-full flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300">
                                            <BookOpen size={40} />
                                        </div>
                                        <h2 className="text-2xl font-bold text-white mb-2 group-hover:text-[#3B82F6] transition-colors">Revision Notes</h2>
                                        <p className="text-gray-400">Access comprehensive chapter-wise notes and revision guides.</p>
                                    </div>
                                </div>
                            </div>
                        )}
                        
                        {/* SYLLABUS VIEW */}
                        {currentPage === 'syllabus-view' && selectedSubject && (
                            <div className="bg-[#0F172A] min-h-screen pb-20 animate-fade-in">
                                <div className="bg-[#0F172A]/90 backdrop-blur-xl border-b border-white/10 py-4 shadow-sm sticky top-16 z-30">
                                    <div className="max-w-7xl mx-auto px-4 flex items-center text-sm text-gray-400 font-medium">
                                        <span onClick={() => navigateTo('subjects')} className="cursor-pointer hover:text-[#3B82F6] transition-colors">Subjects</span>
                                        <ChevronRight size={14} className="mx-3 text-gray-600" />
                                        <span onClick={() => navigateTo('subject-selection', selectedSubject)} className="cursor-pointer hover:text-[#3B82F6] transition-colors">{selectedSubject.title}</span>
                                        <ChevronRight size={14} className="mx-3 text-gray-600" />
                                        <span className="font-bold text-white bg-white/10 px-2 py-1 rounded-md">Syllabus</span>
                                    </div>
                                </div>
                                <div className="max-w-5xl mx-auto px-4 mt-8">
                                    <div className="bg-[#1E293B]/60 backdrop-blur-md rounded-[2rem] shadow-xl border border-white/10 overflow-hidden mb-8">
                                        <div className="flex justify-between items-center p-6 border-b border-white/10 bg-white/5">
                                            <h2 className="font-bold text-white flex items-center text-lg">
                                                <div className="bg-pink-500/20 p-2 rounded-lg mr-3"><ClipboardList size={20} className="text-pink-400" /></div>
                                                {selectedSubject.title} Syllabus
                                            </h2>
                                            <div className="flex space-x-2">
                                                <button 
                                                    onClick={() => {
                                                        if (selectedSubject.syllabusUrl) {
                                                            window.open(selectedSubject.syllabusUrl, '_blank');
                                                            showNotification("Opening Syllabus...", "success");
                                                        } else {
                                                            showNotification("Syllabus not uploaded yet.", "error");
                                                        }
                                                    }}
                                                    className="flex items-center px-5 py-2 bg-pink-500 text-white text-xs font-bold rounded-xl hover:bg-pink-600 hover:shadow-[0_0_15px_rgba(236,72,153,0.4)] transition-all active:scale-95"
                                                >
                                                    <Download size={16} className="mr-2" /> Download
                                                </button>
                                            </div>
                                        </div>
                                        <div className="h-[800px] bg-[#0F172A] relative flex justify-center overflow-y-auto custom-scrollbar p-8">
                                            <div className="w-full max-w-[800px] bg-white min-h-full shadow-2xl p-16 my-4 rounded-sm border-none animate-slide-up">
                                                 <div className="border-b-4 border-pink-500 pb-6 mb-10">
                                                    <h1 className="text-4xl font-extrabold text-[#1B1F3B] mb-3">{selectedSubject.title} Syllabus</h1>
                                                    <div className="flex gap-3">
                                                        <span className="bg-pink-50 text-pink-800 text-xs px-3 py-1.5 rounded-full font-bold uppercase tracking-wider">Official 2025</span>
                                                    </div>
                                                </div>
                                                <div className="space-y-8 text-gray-800 leading-relaxed text-lg">
                                                    {selectedSubject.syllabusUrl ? (
                                                        <div className="bg-pink-50 border-l-4 border-pink-500 p-6 rounded-r-xl">
                                                            <p className="font-bold text-pink-900 mb-1 flex items-center"><CheckCircle size={18} className="mr-2"/> PDF Available</p>
                                                            <p className="text-sm text-pink-700">Click the download button above to view the full Syllabus PDF.</p>
                                                        </div>
                                                    ) : (
                                                        <div className="bg-yellow-50 border-l-4 border-yellow-400 p-6 rounded-r-xl">
                                                            <p className="font-bold text-yellow-900 mb-1 flex items-center"><AlertTriangle size={18} className="mr-2"/> No Syllabus Found</p>
                                                            <p className="text-sm text-yellow-800">The syllabus for this subject hasn't been uploaded by the admin yet.</p>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {currentPage === 'subject-detail' && selectedSubject && (
                            <div className="bg-[#0F172A] min-h-screen pb-20 animate-fade-in">
                                <div className="bg-[#1E293B]/50 border-b border-white/5 pb-16 pt-10 relative overflow-hidden">
                                    <div className="absolute top-0 right-0 p-20 opacity-5 pointer-events-none grayscale">
                                        {selectedSubject.IconComponent ? <selectedSubject.IconComponent size={300} className="text-white" /> : null}
                                    </div>
                                    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
                                        <div className="flex gap-4">
                                            <button onClick={() => navigateTo('subjects')} className="text-gray-400 hover:text-white mb-8 flex items-center text-sm font-bold bg-white/5 hover:bg-white/10 w-fit px-4 py-2 rounded-full transition-colors border border-white/5">
                                                <ChevronRight className="rotate-180 mr-1" size={16} /> Back to Subjects
                                            </button>
                                            <button onClick={() => navigateTo('subject-selection', selectedSubject)} className="text-gray-400 hover:text-white mb-8 flex items-center text-sm font-bold bg-white/5 hover:bg-white/10 w-fit px-4 py-2 rounded-full transition-colors border border-white/5">
                                                <ChevronRight className="rotate-180 mr-1" size={16} /> Selection Menu
                                            </button>
                                        </div>
                                        <div className="flex flex-col md:flex-row md:items-center justify-between gap-8">
                                            <div className="flex items-center gap-8">
                                                <div className={`w-24 h-24 rounded-3xl bg-gradient-to-br ${selectedSubject.gradient} flex items-center justify-center shadow-2xl text-white`}>
                                                    {selectedSubject.IconComponent ? <selectedSubject.IconComponent size={40} /> : null}
                                                </div>
                                                <div>
                                                    <h1 className="text-4xl md:text-5xl font-extrabold text-white mb-3 tracking-tight">{selectedSubject.title} Notes</h1>
                                                    <p className="text-gray-400 text-lg max-w-xl">{selectedSubject.fullDescription}</p>
                                                </div>
                                            </div>
                                            <div className="flex flex-col sm:flex-row gap-4">
                                                <button onClick={() => showNotification("Full Bundle added to cart")} className="flex items-center justify-center px-8 py-4 bg-[#3B82F6] text-white rounded-2xl shadow-lg hover:shadow-[0_0_20px_rgba(59,130,246,0.4)] hover:bg-blue-600 text-sm font-bold transition-all active:scale-95">
                                                    <Download size={20} className="mr-2" /> Download All PDFs
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-12">
                                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-10">
                                        <div className="lg:col-span-2 space-y-6">
                                            {selectedSubject.units && selectedSubject.units.length > 0 ? (
                                                selectedSubject.units.map((unit, idx) => (
                                                    <AccordionUnit key={idx} unit={unit} subject={selectedSubject} onChapterClick={(chap) => navigateTo('chapter-view', selectedSubject, chap)} />
                                                ))
                                            ) : (
                                                <div className="bg-[#1E293B]/50 p-12 rounded-[2rem] text-center border-2 border-dashed border-white/10">
                                                    <p className="text-gray-400 font-medium">No chapters found for {selectedSubject.title}.</p>
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {currentPage === 'chapter-view' && selectedChapter && selectedSubject && (
                            <div className="bg-[#0F172A] min-h-screen pb-20 animate-fade-in">
                                <div className="bg-[#0F172A]/90 backdrop-blur-xl border-b border-white/10 py-4 shadow-sm sticky top-16 z-30">
                                    <div className="max-w-7xl mx-auto px-4 flex items-center text-sm text-gray-400 font-medium">
                                        <span onClick={() => navigateTo('subjects')} className="cursor-pointer hover:text-[#3B82F6] transition-colors">Subjects</span>
                                        <ChevronRight size={14} className="mx-3 text-gray-600" />
                                        <span onClick={() => navigateTo('subject-selection', selectedSubject)} className="cursor-pointer hover:text-[#3B82F6] transition-colors">{selectedSubject.title}</span>
                                        <ChevronRight size={14} className="mx-3 text-gray-600" />
                                        <span onClick={() => navigateTo('subject-detail', selectedSubject)} className="cursor-pointer hover:text-[#3B82F6] transition-colors">Notes</span>
                                        <ChevronRight size={14} className="mx-3 text-gray-600" />
                                        <span className="font-bold text-white bg-white/10 px-2 py-1 rounded-md">{selectedChapter.title}</span>
                                    </div>
                                </div>
                                <div className="max-w-7xl mx-auto px-4 mt-8 grid grid-cols-1 lg:grid-cols-4 gap-8">
                                    <div className="lg:col-span-3">
                                        <div className="bg-[#1E293B]/60 backdrop-blur-md rounded-[2rem] shadow-xl border border-white/10 overflow-hidden mb-8">
                                            <div className="flex justify-between items-center p-6 border-b border-white/10 bg-white/5">
                                                <h2 className="font-bold text-white flex items-center text-lg">
                                                    <div className="bg-[#3B82F6]/20 p-2 rounded-lg mr-3"><FileText size={20} className="text-[#3B82F6]" /></div>
                                                    {selectedChapter.title}
                                                </h2>
                                                <div className="flex space-x-2">
                                                    <button 
                                                        onClick={() => {
                                                            if (selectedChapter.pdfUrl) {
                                                                window.open(selectedChapter.pdfUrl, '_blank');
                                                                showNotification("Opening PDF...", "success");
                                                            } else {
                                                                showNotification("PDF URL not found.", "error");
                                                            }
                                                        }}
                                                        className="flex items-center px-5 py-2 bg-[#3B82F6] text-white text-xs font-bold rounded-xl hover:bg-blue-600 hover:shadow-[0_0_15px_rgba(59,130,246,0.4)] transition-all active:scale-95"
                                                    >
                                                        <Download size={16} className="mr-2" /> Download
                                                    </button>
                                                </div>
                                            </div>
                                            <div className="h-[800px] bg-[#0F172A] relative flex justify-center overflow-y-auto custom-scrollbar p-8">
                                                <div className="w-full max-w-[800px] bg-white min-h-full shadow-2xl p-16 my-4 rounded-sm border-none animate-slide-up">
                                                    <div className="border-b-4 border-[#3B82F6] pb-6 mb-10">
                                                        <h1 className="text-4xl font-extrabold text-[#1B1F3B] mb-3">{selectedChapter.title}</h1>
                                                        <div className="flex gap-3">
                                                            <span className="bg-blue-50 text-blue-800 text-xs px-3 py-1.5 rounded-full font-bold uppercase tracking-wider">IGCSE {selectedSubject.title}</span>
                                                        </div>
                                                    </div>
                                                    <div className="space-y-8 text-gray-800 leading-relaxed text-lg">
                                                        <p className="font-serif"><strong>{selectedChapter.desc}</strong></p>
                                                        {selectedChapter.pdfUrl ? (
                                                            <div className="bg-blue-50 border-l-4 border-blue-500 p-6 rounded-r-xl">
                                                                <p className="font-bold text-blue-900 mb-1 flex items-center"><CheckCircle size={18} className="mr-2"/> PDF Available</p>
                                                                <p className="text-sm text-blue-700">Click the download button above to view the full PDF notes for this chapter.</p>
                                                            </div>
                                                        ) : (
                                                            <div className="bg-yellow-50 border-l-4 border-yellow-400 p-6 rounded-r-xl">
                                                                <p className="font-bold text-yellow-900 mb-1 flex items-center"><AlertTriangle size={18} className="mr-2"/> Preview Mode</p>
                                                                <p className="text-sm text-yellow-800">This is a preview. No specific PDF URL was found in the database for this note.</p>
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {currentPage === 'about' && (
                            <div className="bg-[#0F172A] min-h-screen animate-fade-in pt-24">
                                <div className="max-w-4xl mx-auto px-4">
                                    <div className="text-center mb-20">
                                        <h1 className="text-5xl font-extrabold text-white mb-8">Our Mission</h1>
                                        <p className="text-xl text-gray-400 leading-relaxed max-w-2xl mx-auto">We believe high-quality education should be accessible and clutter-free.</p>
                                    </div>
                                </div>
                            </div>
                        )}

                        {currentPage === 'contact' && (
                            <div className="bg-[#0F172A] min-h-screen flex items-center justify-center py-20 px-4 animate-fade-in relative overflow-hidden">
                                <div className="bg-[#1E293B]/80 backdrop-blur-xl max-w-6xl w-full rounded-[2.5rem] shadow-2xl border border-white/10 overflow-hidden flex flex-col md:flex-row relative z-10">
                                    <div className="bg-gradient-to-br from-[#0F172A] to-[#1E293B] p-16 md:w-2/5 flex flex-col justify-between relative overflow-hidden border-r border-white/5">
                                        <div className="relative z-10">
                                            <h2 className="text-4xl font-bold mb-6 text-white">Get in touch</h2>
                                            <p className="text-gray-400 mb-12 text-lg">Found a mistake? Have a suggestion? Or just want to say hi?</p>
                                        </div>
                                    </div>
                                    <div className="p-16 md:w-3/5">
                                        <form onSubmit={(e) => { e.preventDefault(); showNotification("Message sent successfully!"); }}>
                                            <button type="submit" className="w-full bg-gradient-to-r from-[#3B82F6] to-[#8B5CF6] text-white font-bold py-5 rounded-xl shadow-lg hover:shadow-[0_0_25px_rgba(139,92,246,0.5)] transition-all transform active:scale-95">Send Message</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        )}

                        {currentPage === 'login' && <LoginPage />}
                        {currentPage === 'admin' && <AdminPanel supabaseUrl={supabaseUrl} supabaseKey={supabaseKey} showNotification={showNotification} />}
                    </main>

                    <Footer navigateTo={navigateTo} />
                    <Toast notification={notification} />
                </div>
            );
        };

        // Mount the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>